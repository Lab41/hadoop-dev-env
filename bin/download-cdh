#!/bin/sh

set -e

cd `dirname $0`/..

CDH_MAJOR=5
CDH_VERSION=cdh5.0.0-beta-2

HADOOP=hadoop-2.2.0-$CDH_VERSION.tar.gz
HBASE=hbase-0.96.1.1-$CDH_VERSION.tar.gz
SEARCH=search-1.0.0-$CDH_VERSION.tar.gz
SOLR=solr-4.4.0-$CDH_VERSION.tar.gz
SPARK=spark-0.9.0-$CDH_VERSION.tar.gz
ZOOKEEPER=zookeeper-3.4.5-$CDH_VERSION.tar.gz

if [ ! -e downloads ]; then
    mkdir -p downloads
fi

cd downloads

curl -O \
    http://archive.cloudera.com/cdh$CDH_MAJOR/cdh/$CDH_MAJOR/$HADOOP \
    http://archive.cloudera.com/cdh$CDH_MAJOR/cdh/$CDH_MAJOR/$HBASE \
    http://archive.cloudera.com/cdh$CDH_MAJOR/cdh/$CDH_MAJOR/$SEARCH \
    http://archive.cloudera.com/cdh$CDH_MAJOR/cdh/$CDH_MAJOR/$SOLR \
    http://archive.cloudera.com/cdh$CDH_MAJOR/cdh/$CDH_MAJOR/$SPARK \
    http://archive.cloudera.com/cdh$CDH_MAJOR/cdh/$CDH_MAJOR/$ZOOKEEPER \

cd ..

mkdir -p cdh/$CDH_VERSION
cd cdh/$CDH_VERSION

tar -xvf ../../downloads/$HADOOP
tar -xvf ../../downloads/$HBASE
tar -xvf ../../downloads/$SEARCH
tar -xvf ../../downloads/$SOLR
tar -xvf ../../downloads/$SPARK
tar -xvf ../../downloads/$ZOOKEEPER
